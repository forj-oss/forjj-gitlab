#!/bin/bash
# This file is generated by BuildEnv. Avoid updating it manually.
# Instead, contribute to BuildEnv and use 'be_update'
#

MOD=core
    
# From BuildEnv bin/pre-wrapper.sh

BUILD_SCRIPT_PATH=$(dirname $0)
BUILD_SCRIPT_LIB_PATH=$(dirname $BUILD_SCRIPT_PATH)/lib

if [[ ! -f $BUILD_SCRIPT_LIB_PATH/run-build-env.sh ]]
then
    echo "Unable to load build-env.sh. '$BUILD_SCRIPT_LIB_PATH/run-build-env.sh' not found"
    exit 1
fi

source $BUILD_SCRIPT_LIB_PATH/run-build-env.sh
# Added from ../build-env/bin/inenv
# From BuildEnv bin/inenv.sh

if [[ "$1" == --help ]]
then
    echo "usage is inenv [module]

inenv is used to enter in the builder module container with bash to get build context."
    exit
fi

if [[ -f $BUILD_ENV_PROJECT/build-env.modules ]]
then
    MODS=(`cat $BUILD_ENV_PROJECT/build-env.modules`)

    case ${#MODS[@]} in
    0) IMAGE=alpine ;;
    1) IMAGE="${BE_PROJECT}-${MODS[0]}-env" ; MOD=${MODS[0]};;
    *)
        for MOD in ${MODS[@]}
        do
            if [[ $MOD = $1 ]]
            then
                IMAGE="${BE_PROJECT}-$1-env"
                break
            fi
        done
        ;;
    esac
else
    IMAGE=alpine
fi

docker_run $IMAGE bash
